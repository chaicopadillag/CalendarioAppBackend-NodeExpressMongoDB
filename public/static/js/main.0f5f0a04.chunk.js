(this["webpackJsonpcalendario-app"]=this["webpackJsonpcalendario-app"]||[]).push([[0],{111:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(8),r=n.n(c),s=n(9),o=n(25),i=n(66),u=n(5),l="[uiOpenModal]",j="[uiCloseModal]",b="[eventoActivo]",d="[eventoCrear]",p="[eventoNull]",x="[eventoUpdate]",h="[eventoDelete]",O="[eventGetAll]",m="[eventCleanLogout]",v="[authChekingFinish]",f="[authLogin]",g="[authRegister]",y="[authLogout]",N={estadoModal:!1},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return Object(u.a)(Object(u.a)({},e),{},{estadoModal:!0});case j:return Object(u.a)(Object(u.a)({},e),{},{estadoModal:!1});default:return e}},w=n(58),T=n(18),S=n.n(T),E={eventos:[],eventoActivo:null},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(u.a)(Object(u.a)({},e),{},{eventoActivo:t.evento});case d:return Object(u.a)(Object(u.a)({},e),{},{eventos:[].concat(Object(w.a)(e.eventos),[t.evento])});case x:return Object(u.a)(Object(u.a)({},e),{},{eventos:e.eventos.map((function(e){return e.id===t.evento.id?t.evento:e}))});case h:return Object(u.a)(Object(u.a)({},e),{},{eventos:e.eventos.filter((function(t){return t.id!==e.eventoActivo.id})),eventoActivo:null});case O:return Object(u.a)(Object(u.a)({},e),{},{eventos:Object(w.a)(t.payload)});case p:return Object(u.a)(Object(u.a)({},e),{},{eventoActivo:null});case m:return E;default:return e}},D={checking:!0},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:case g:return Object(u.a)(Object(u.a)({},e),{},{checking:!1,authUser:t.payload});case v:return Object(u.a)(Object(u.a)({},e),{},{checking:!1,authUser:null});case y:return{checking:!1};default:return e}},A=Object(o.c)({ui:k,evento:C,auth:I}),R="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,L=Object(o.e)(A,R(Object(o.a)(i.a))),M=n(21),U=n(10),P=n(12),_=n.n(P),q=n(24),G=n(13),F=n.n(G),H="https://calendario-app-react.herokuapp.com/api/",V=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(H).concat(e);return"GET"===n?fetch(a):fetch(a,{method:n,headers:{"Content-type":"application/json"},body:JSON.stringify(t)})},J=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(H).concat(e),c=localStorage.getItem("token")||"";return"GET"===n?fetch(a,{method:n,headers:{"Content-type":"application/json","x-token":c}}):fetch(a,{method:n,headers:{"Content-type":"application/json","x-token":c},body:JSON.stringify(t)})},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{start:S()(e.start).toDate(),end:S()(e.end).toDate()})}))},X=function(e){return{type:O,payload:e}},B=function(e){return{type:d,evento:e}},Y=function(){return{type:p}},K=function(e){return{type:x,evento:e}},Q=function(){return{type:h}},W=function(){return function(e){localStorage.clear(),e(Z()),e({type:m})}},Z=function(){return{type:y}},$=function(e){return{type:f,payload:e}},ee=function(e){return{type:g,payload:e}},te=function(){return{type:v}},ne=n(16),ae=n(14),ce=n(15),re=n(2),se=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.auth})).authUser;return Object(re.jsxs)("div",{className:"navbar navbar-dark bg-dark mb-4",children:[Object(re.jsx)("span",{className:"text-warning",children:null===t||void 0===t?void 0:t.nombre}),Object(re.jsxs)("button",{className:"btn btn-warning",onClick:function(){e(W())},children:[Object(re.jsx)(ae.a,{icon:ce.e}),"Salir"]})]})},oe=n(57),ie={allDay:"Todo el d\xeda",previous:"<",next:">",today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda",agenda:"Agenda",date:"Fecha",time:"Hora",event:"Evento",noEventsInRange:"No hay eventos en este rango",showMore:function(e){return"+ Ver m\xe1s (".concat(e,")")}},ue=(n(81),function(e){var t=e.event,n=t.title,a=t.user;return Object(re.jsxs)("div",{children:[Object(re.jsx)("span",{children:n}),Object(re.jsxs)("strong",{children:[" - ",a.nombre]})]})}),le=n(29),je=n(52),be=n.n(je),de=n(53),pe=n.n(de),xe=function(){return{type:l}},he={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};be.a.setAppElement("#root");var Oe=S()().minutes(0).seconds(0).add(1,"hours"),me=Oe.clone().add(1,"hours"),ve=function(){var e=Object(a.useState)(Oe.toDate()),t=Object(ne.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(me.toDate()),o=Object(ne.a)(r,2),i=o[0],l=o[1],b=Object(a.useState)(!1),d=Object(ne.a)(b,2),p=d[0],x=d[1],h=Object(s.c)((function(e){return e.ui})).estadoModal,O=Object(s.c)((function(e){return e.evento})).eventoActivo,m=Object(s.b)(),v={title:"",note:"",start:Oe.toDate(),end:me.toDate()},f=Object(a.useState)(v),g=Object(ne.a)(f,2),y=g[0],N=g[1],k=y.title,w=y.note;Object(a.useEffect)((function(){O?(N(O),c(O.start),l(O.end)):N(v)}),[O,N]);var T=function(e){var t=e.target;N(Object(u.a)(Object(u.a)({},y),{},Object(le.a)({},t.name,t.value))),"title"===t.name&&x(!1)},E=function(){N(v),c(Oe.toDate()),l(me.toDate()),m(Y()),m({type:j})};return Object(re.jsxs)(be.a,{isOpen:h,onRequestClose:E,style:he,closeTimeoutMS:300,className:"modal",overlayClassName:"modal-fondo",children:[Object(re.jsxs)("h1",{children:[" ",O?"Editando evento":"Nuevo evento"," "]}),Object(re.jsx)("hr",{}),Object(re.jsxs)("form",{className:"container",method:"POST",onSubmit:function(e){e.preventDefault();var t,a,c=S()(n),r=S()(i);c.isSameOrAfter(r)?F()("Error!","La fecha final del evento debe ser mayor a la de fecha fncial","warning"):k.trim().length<2?x(!0):(m(O?(a=y,function(){var e=Object(q.a)(_.a.mark((function e(t){var n,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J("events/".concat(a.id),a,"PUT");case 3:return n=e.sent,e.next=6,n.json();case 6:if(201===(c=e.sent).status){e.next=9;break}throw{status:c.status,statusText:c.statusText};case 9:t(K(a)),F()({title:"El evento se actualiz\xf3 correctamente",text:c.statusText,icon:"success"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),F()({title:"Error en actualizar",text:e.t0.statusText,icon:"error"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()):(t=Object(u.a)(Object(u.a)({},y),{},{start:n,end:i}),function(){var e=Object(q.a)(_.a.mark((function e(n,a){var c,r,s,o,i,l;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=a().auth.authUser,r=c.uid,s=c.nombre,e.next=4,J("events",t,"POST");case 4:return o=e.sent,e.next=7,o.json();case 7:if(201===(i=e.sent).status){e.next=10;break}throw{status:i.status,statusText:i.statusText};case 10:l=i.evento,n(B(Object(u.a)(Object(u.a)({},t),{},{id:l.id,user:{_id:r,nombre:s}}))),F()({title:"Registro ex\xedtoso",text:i.statusText,icon:"success"}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),F()({title:"Error de Registro",text:e.t0.statusText,icon:"error"});case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}())),E())},children:[Object(re.jsxs)("div",{className:"form-group",children:[Object(re.jsx)("label",{children:"Fecha y hora inicio"}),Object(re.jsx)(pe.a,{className:"form-text form-control",onChange:function(e){c(e),N(Object(u.a)(Object(u.a)({},y),{},{fechaFinal:e}))},value:n,name:"start"})]}),Object(re.jsxs)("div",{className:"form-group",children:[Object(re.jsx)("label",{children:"Fecha y hora fin"}),Object(re.jsx)(pe.a,{className:"form-text form-control",onChange:function(e){l(e),N(Object(u.a)(Object(u.a)({},y),{},{fechaFinal:e}))},value:i,minDate:n,name:"end"})]}),Object(re.jsx)("hr",{}),Object(re.jsxs)("div",{className:"form-group",children:[Object(re.jsx)("label",{children:"Titulo y notas"}),Object(re.jsx)("input",{type:"text",className:"form-control ".concat(p&&"is-invalid"),placeholder:"T\xedtulo del evento",name:"title",autoComplete:"off",value:k,onChange:T}),Object(re.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Una descripci\xf3n corta"})]}),Object(re.jsxs)("div",{className:"form-group",children:[Object(re.jsx)("textarea",{type:"text",className:"form-control",placeholder:"Notas",rows:"5",name:"note",value:w,onChange:T}),Object(re.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Informaci\xf3n adicional"})]}),Object(re.jsxs)("button",{type:"submit",className:"btn btn-outline-primary btn-block",children:[Object(re.jsx)("i",{className:"far fa-save"}),Object(re.jsx)("span",{children:" Guardar"})]})]})]})},fe=function(){var e=Object(s.b)();return Object(re.jsx)("button",{className:"btn btn-primary fab",onClick:function(){e(xe())},children:Object(re.jsx)(ae.a,{icon:ce.d})})},ge=function(){var e=Object(s.b)();return Object(re.jsx)("button",{className:"btn btn-danger fabDelete",onClick:function(){e(function(){var e=Object(q.a)(_.a.mark((function e(t,n){var a,c,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n().evento.eventoActivo.id,e.next=4,J("events/".concat(a),{},"DELETE");case 4:return c=e.sent,e.next=7,c.json();case 7:if(201===(r=e.sent).status){e.next=10;break}throw{status:r.status,statusText:r.statusText};case 10:t(Q()),F()({title:"Eliminaci\xf3n correcta",text:r.statusText,icon:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),F()({title:"Error al eliminar",text:e.t0.statusText,icon:"error"});case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}())},children:Object(re.jsx)(ae.a,{icon:ce.f})})};S.a.locale("es");var ye=Object(oe.b)(S.a),Ne=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.evento})),n=t.eventos,c=t.eventoActivo,r=Object(s.c)((function(e){return e.auth})).authUser,o=Object(a.useState)(localStorage.getItem("lastView")||"month"),i=Object(ne.a)(o,2),u=i[0],l=i[1];Object(a.useEffect)((function(){e(function(){var e=Object(q.a)(_.a.mark((function e(t){var n,a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J("events");case 3:return n=e.sent,e.next=6,n.json();case 6:if(201===(a=e.sent).status){e.next=9;break}throw{status:a.status,statusText:a.statusText};case 9:c=z(a.eventos),t(X(c)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),F()({title:"Error en cargar datos",text:e.t0.statusText,icon:"error"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}())}),[e]);var j=function(t){e(function(e){return{type:b,evento:e}}(t))};return Object(re.jsxs)("div",{children:[Object(re.jsx)(se,{}),Object(re.jsx)(oe.a,{localizer:ye,events:n,startAccessor:"start",endAccessor:"end",style:{height:500},messages:ie,eventPropGetter:function(e,t,n,a){return{style:{backgroundColor:r.uid===e.user._id?"#7b4ca0":"#465660",borderRadius:"0px",opacity:.8,display:"block",color:"white"}}},onDoubleClickEvent:function(t){j(t),e(xe())},onSelectEvent:j,onView:function(e){localStorage.setItem("lastView",e),l(e)},view:u,onSelectSlot:function(t){e(Y())},selectable:!0,components:{event:ue}}),c&&Object(re.jsx)(ge,{}),Object(re.jsx)(fe,{}),Object(re.jsx)(ve,{})]})},ke=function(){return Object(re.jsx)("div",{className:"wrapper bg-white d-flex justify-content-center",children:Object(re.jsxs)("div",{className:"text-center d-flex",children:[Object(re.jsx)("div",{className:"spinner-border text-primary",role:"status"}),Object(re.jsx)("h6",{className:"d-inline-block ml-2 mt-2",children:"Cargando..."})]})})},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(ne.a)(t,2),c=n[0],r=n[1],s=function(e){var t=e.target;r(Object(u.a)(Object(u.a)({},c),{},Object(le.a)({},t.name,t.value)))},o=function(){r(e)};return[c,s,o]},Te=function(){var e=Object(s.b)(),t=we({correo:"",contrasenia:""}),n=Object(ne.a)(t,2),a=n[0],c=n[1],r=a.correo,o=a.contrasenia;return Object(re.jsxs)("div",{className:"wrapper bg-white",children:[Object(re.jsx)("div",{className:"h2 text-center",children:"Calendario App"}),Object(re.jsx)("div",{className:"h4 text-muted text-center pt-2",children:"Ingrese tus datos para iniciar sesi\xf3n"}),Object(re.jsxs)("form",{className:"pt-3",method:"POST",onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(q.a)(_.a.mark((function n(a){var c,r,s;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,V("auth",{correo:e,contrasenia:t},"POST");case 3:return c=n.sent,n.next=6,c.json();case 6:if(200===(r=n.sent).status){n.next=9;break}throw{status:r.status,statusText:r.statusText};case 9:s=r.user,localStorage.setItem("token",s.token),localStorage.setItem("token-init-date",(new Date).getTime()),a($({nombre:s.nombre,correo:s.correo,uid:s.uid,token:s.token})),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),F()({title:"Error de Autenticaci\xf3n",text:n.t0.statusText,icon:"error"});case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e){return n.apply(this,arguments)}}()}(r,o))},children:[Object(re.jsx)("div",{className:"form-group py-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.a}),Object(re.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",required:!0,className:"",name:"correo",onChange:c,value:r})]})}),Object(re.jsx)("div",{className:"form-group py-1 pb-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.c}),Object(re.jsx)("input",{type:"password",placeholder:"Ingresa tu contrase\xf1a",required:!0,className:"",name:"contrasenia",onChange:c,value:o})]})}),Object(re.jsxs)("div",{className:"d-flex align-items-start",children:[Object(re.jsx)("div",{className:"remember",children:Object(re.jsxs)("label",{className:"option text-muted",children:["Recu\xe9rdame",Object(re.jsx)("input",{type:"radio",name:"radio"})," ",Object(re.jsx)("span",{className:"checkmark"})]})}),Object(re.jsx)("div",{className:"ml-auto",children:Object(re.jsx)("a",{href:"/auth/recovery",id:"forgot",children:"\xbfHas olvidado tu contrase\xf1a?"})})]}),Object(re.jsx)("button",{className:"btn btn-block text-center my-3",type:"submit",children:"Iniciar sesi\xf3n"}),Object(re.jsxs)("div",{className:"text-center pt-3 text-muted",children:["\xbfNo es un miembro? ",Object(re.jsx)(M.c,{to:"/auth/register",children:"Reg\xedstrate"})]})]})]})},Se=function(){var e=Object(s.b)(),t=we({nombre:"",correo:"",contrasenia:"",contrasenia2:""}),n=Object(ne.a)(t,2),a=n[0],c=n[1],r=a.nombre,o=a.correo,i=a.contrasenia,u=a.contrasenia2;return Object(re.jsxs)("div",{className:"wrapper bg-white",children:[Object(re.jsx)("div",{className:"h2 text-center",children:"Calendario App"}),Object(re.jsx)("div",{className:"h4 text-muted text-center pt-2",children:"Ingrese tus datos para Registrarte"}),Object(re.jsxs)("form",{className:"pt-3",method:"POST",onSubmit:function(t){t.preventDefault(),i===u?e(function(e,t,n){return function(){var a=Object(q.a)(_.a.mark((function a(c){var r,s,o;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,V("auth/register",{nombre:e,correo:t,contrasenia:n},"POST");case 3:return r=a.sent,a.next=6,r.json();case 6:if(201===(s=a.sent).status){a.next=9;break}throw{status:s.status,statusText:s.statusText};case 9:o=s.usuario,localStorage.setItem("token",o.token),localStorage.setItem("token-init-date",(new Date).getTime()),c(ee({nombre:o.nombre,correo:o.correo,uid:o.uid,token:o.token})),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),F()({title:"Error de Registro",text:a.t0.statusText,icon:"error"});case 18:case"end":return a.stop()}}),a,null,[[0,15]])})));return function(e){return a.apply(this,arguments)}}()}(r,o,i)):F()({title:"Error de Registro",text:"Las contrase\xf1as no coenciden",icon:"warning"})},children:[Object(re.jsx)("div",{className:"form-group py-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.g}),Object(re.jsx)("input",{type:"text",placeholder:"Tu nombre",required:!0,className:"",name:"nombre",value:r,onChange:c})]})}),Object(re.jsx)("div",{className:"form-group py-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.a}),Object(re.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",required:!0,className:"",name:"correo",value:o,onChange:c})]})}),Object(re.jsx)("div",{className:"form-group py-1 pb-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.c}),Object(re.jsx)("input",{type:"password",placeholder:"Ingresa tu contrase\xf1a",required:!0,className:"",name:"contrasenia",value:i,onChange:c})]})}),Object(re.jsx)("div",{className:"form-group py-1 pb-2",children:Object(re.jsxs)("div",{className:"input-field",children:[Object(re.jsx)(ae.a,{icon:ce.b}),Object(re.jsx)("input",{type:"password",placeholder:"Repite tu contrase\xf1a",required:!0,className:"",name:"contrasenia2",value:u,onChange:c})]})}),Object(re.jsx)("button",{className:"btn btn-block text-center my-3",type:"submit",children:"Registrarse"}),Object(re.jsxs)("div",{className:"text-center pt-3 text-muted",children:["\xbfYa tienes una cuenta? ",Object(re.jsx)(M.c,{to:"/auth/login",children:"Inicia sesi\xf3n"})]})]})]})},Ee=function(){return Object(re.jsxs)(U.d,{children:[Object(re.jsx)(U.b,{exact:!0,path:"/auth/login",component:Te}),Object(re.jsx)(U.b,{exact:!0,path:"/auth/register",component:Se}),Object(re.jsx)(U.a,{to:"/auth/login"})]})},Ce=n(42),De=function(e){var t=e.isLogin,n=e.component,a=Object(Ce.a)(e,["isLogin","component"]);return Object(re.jsx)(U.b,Object(u.a)(Object(u.a)({},a),{},{component:function(e){return t?Object(re.jsx)(n,Object(u.a)({},e)):Object(re.jsx)(U.a,{to:"/auth/login"})}}))},Ie=function(e){var t=e.isLogin,n=e.component,a=Object(Ce.a)(e,["isLogin","component"]);return Object(re.jsx)(U.b,Object(u.a)(Object(u.a)({},a),{},{component:function(e){return t?Object(re.jsx)(U.a,{to:"/"}):Object(re.jsx)(n,Object(u.a)({},e))}}))},Ae=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.auth})),n=t.checking,c=t.authUser;return Object(a.useEffect)((function(){e(function(){var e=Object(q.a)(_.a.mark((function e(t){var n,a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J("auth/verify-token");case 3:return n=e.sent,e.next=6,n.json();case 6:if(200===(a=e.sent).status){e.next=9;break}throw{status:a.status,statusText:a.statusText};case 9:c=a.user,localStorage.setItem("token",c.token),localStorage.setItem("token-init-date",(new Date).getTime()),t($({nombre:c.nombre,uid:c.uid,token:c.token})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),t(te());case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}())}),[e]),n?Object(re.jsx)(ke,{}):Object(re.jsx)(M.a,{children:Object(re.jsxs)(U.d,{children:[Object(re.jsx)(Ie,{path:"/auth",component:Ee,isLogin:!!(null===c||void 0===c?void 0:c.uid)}),Object(re.jsx)(De,{exact:!0,path:"/",component:Ne,isLogin:!!(null===c||void 0===c?void 0:c.uid)}),Object(re.jsx)(U.a,{to:"/auth"})]})})},Re=function(){return Object(re.jsx)(s.a,{store:L,children:Object(re.jsx)(M.b,{children:Object(re.jsx)(Ae,{})})})};n(111);r.a.render(Object(re.jsx)(Re,{}),document.getElementById("root"))}},[[112,1,2]]]);
//# sourceMappingURL=main.0f5f0a04.chunk.js.map